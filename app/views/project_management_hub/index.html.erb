<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Divs in One Row</title>
        <style>
            .container {
                display: flex;
            }
            .box {
                width: 100px;
                height: 20px;
                background-color: lightblue;
                margin: 10px;
            }
        </style>
    </head>

    <body>
        <h1>Project Management Hub</h1>
        <h2>email : <%= @user.email %></h2>
        <h2>user : <%= @role %></h2>

        <button id="openProjectModal">Create New Project</button>

        <%= button_to "Logout", "/logout", method: :get%>

        <div id="projectModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Create New Project</h2>
            <%= form_with(model: @project,url: create_project_path, method: :post, local: true, class: 'project-form') do |form| %>
            <div>
                <%= form.label :name, 'Project Name' %>
                <%= form.text_field :name, required: true %>
            </div>

            <div>
                <%= form.label :description, 'Project Description' %>
                <%= form.text_area :description %>
            </div>

            <div>
                <%= form.label :objectives, 'Project Objectives' %>
                <%= form.text_area :objectives %>
            </div>

                <div>
                    <%= form.label :start_date, 'Project Start Date' %>
                    <%= form.date_field :start_date %>
                </div>

                <div>
                    <%= form.label :end_date, 'Project End Date' %>
                    <%= form.date_field :end_date %>
                </div>

            <div>
                <%= form.label :status, 'Project Status' %>
                <%= form.select :status, ['active', 'inactive', 'completed'], { selected: 'active' } %>
            </div>

            <div>
                <%= form.label :user_ids, 'Project Members' %>
                <%= form.select :user_ids, User.all.map { |u| [u.full_name, u.id] }, {}, { multiple: true, class: 'user-select' } %>
            </div>

            <div class="form-actions">
                <%= form.submit 'Create Project', class: 'btn btn-primary submit-btn' %>
            </div>
            <% end %>
        </div>
        </div>
    </body>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
    var modal = document.getElementById("projectModal");
    var btn = document.getElementById("openProjectModal");
    var span = document.getElementsByClassName("close")[0];
    var errorMessage = document.getElementById('error-message');

    btn.onclick = function() {
        modal.style.display = "block";
    }

    span.onclick = function() {
        modal.style.display = "none";
    }

    window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        }
    }

    
    if (errorMessage) {
        var message = errorMessage.getAttribute('data-error');
        alert(message);
    }
    });
    </script>
</html>
